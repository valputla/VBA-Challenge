
Sub tickerandtotalVol():
Dim ticker As String
Dim TotalVol As LongLong
TotalVol = 0

Dim SummaryTable As Integer
SummaryTable = 2


lastrow = Cells(Rows.Count, 1).End(xlUp).Row - 1

 'Loop through for Ticker and Total Volume Values
 
    For i = 2 To lastrow
    
            If Cells(i, 1).Value <> Cells(i + 1, 1).Value Then
                ticker = Cells(i, 1).Value
                TotalVol = TotalVol + Cells(i, 7).Value
            
            
                Range("J" & SummaryTable).Value = ticker
                Range("K" & SummaryTable).Value = TotalVol
                SummaryTable = SummaryTable + 1
    
                TotalVol = 0
            
            Else
                TotalVol = TotalVol + Cells(i, 7).Value
            End If
            
    Next i

End Sub



'In order to find the Yearly Change and Percent Change, create opening and closing columns to simplfy equation
Sub openingprice()
Dim openingprice As Double
openingprice = 0
Dim SummaryTable As Integer
SummaryTable = 2

lastrow = Cells(Rows.Count, 3).End(xlUp).Row

 For i = 1 To lastrow
        If Cells(i, 1).Value <> Cells(i + 1, 1).Value Then
        openingprice = Cells(i + 1, 3).Value
        Range("L" & SummaryTable).Value = openingprice
        SummaryTable = SummaryTable + 1
        startingprice = 0
        
        End If
    Next i
End Sub



' Finding the closing prices
Sub closingprice()
Dim closingprice As Double
closingprice = 0
Dim SummaryTable As Integer
SummaryTable = 2

lastrow = Cells(Rows.Count, 6).End(xlUp).Row

 For i = 2 To lastrow
        If Cells(i, 1).Value <> Cells(i + 1, 1).Value Then
        closingprice = Cells(i, 6).Value
        Range("M" & SummaryTable).Value = closingprice
        SummaryTable = SummaryTable + 1
        closingprice = 0
        End If
    Next i
End Sub




'Code to calculate Yearly Change and Percent Change
Sub change()

Dim yearlychange As Double
yearlychange = 0
Dim percentchanged As Single
percentchanged = 0
Dim closingprice As Double

Dim openingprice As Double

Dim SummaryTable As Integer
SummaryTable = 2

lastrow = Cells(Rows.Count, 12).End(xlUp).Row

For i = 2 To lastrow
    closingprice = Cells(i, 13).Value
    openingprice = Cells(i, 12).Value
    yearlychange = closingprice - openingprice
    Range("N" & SummaryTable).Value = yearlychange
    
    PercentChange = (Cells(i, 13).Value - Cells(i, 12).Value) / Cells(i, 12).Value * 100
    Range("O" & SummaryTable).Value = PercentChange
    SummaryTable = SummaryTable + 1
    yearlychange = 0
    PercentChange = 0
 'Conditional Formatting
            If Cells(i, 14).Value < 0 Then
                Cells(i, 14).Interior.ColorIndex = 3
            Else
                Cells(i, 14).Interior.ColorIndex = 4
            End If
Next i
    
End Sub

